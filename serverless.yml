service: schoolio

package:
    individually: true
    exclude:
      - lambda_functions/**
      - node_modules/**
      - venv/**
      - pylintrc
      - "*.json"
      - README.md
      - requirements.txt
      - .gitignore

provider:
  name: aws
  runtime: python3.7

  stage: ${opt:stage, 'funsies'}
  region: us-east-1

# functions:

resources:
  Resources:
    SeventhGradeTable:
      Type: AWS::DynamoDB::Table
      Properties:
        AttributeDefinitions:
          - AttributeName: pk
            AttributeType: S
          - AttributeName: sk
            AttributeType: S
          - AttributeName: data
            AttributeType: S
        KeySchema:
          - AttributeName: pk
            KeyType: HASH
          - AttributeName: sk
            KeyType: RANGE
        GlobalSecondaryIndexes:
          - IndexName: data_index
            KeySchema:
              - AttributeName: sk
                KeyType: HASH
              - AttributeName: data
                KeyType: RANGE
            Projection:
              ProjectionType: ALL
            ProvisionedThroughput:
              ReadCapacityUnits: 2
              WriteCapacityUnits: 2
        ProvisionedThroughput:
          ReadCapacityUnits: 2
          WriteCapacityUnits: 2
        TableName: ${self:service}-${self:provider.stage}

plugins:
  - serverless-python-requirements
  - serverless-pseudo-parameters

custom:
  pythonRequirements:
    dockerizePip: true